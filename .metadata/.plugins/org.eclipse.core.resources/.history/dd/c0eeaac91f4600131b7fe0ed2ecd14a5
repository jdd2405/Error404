package ch.fhnw.error404.DerGrosseDalmuti.server;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

import ch.fhnw.error404.DerGrosseDalmuti.shared.*;

public class Server implements Runnable{
	public static void main(String[] args){
		Server server = new Server();
		Player Jonas = new Player("Jonas");
		Object obj = Jonas;
		String s = "Hello World";
	      try {
	    	  
	    	  // create ServerSocket-listener with port 404
	    	  ServerSocket listener = new ServerSocket(404, 10, null);
	    	  
	    	  while(true){
	    		  
	    		// Wait for and accept an incoming request
				Socket socket = listener.accept();
				
		        // create a new file with an ObjectOutputStream
		        FileOutputStream out = new FileOutputStream("obj.tmp");
		        ObjectOutputStream objOut = new ObjectOutputStream(out);
	
		        // write something in the file
		        objOut.writeObject(s);
		        objOut.writeObject(obj);
		        objOut.flush();
	
		        // create an ObjectInputStream for the file we created before
		        ObjectInputStream ois =
		                new ObjectInputStream(new FileInputStream("obj.tmp"));
	
		        // read and print an object and cast it as string
		        System.out.println("" + (String) ois.readObject());
	
		        // read and print an object and cast it as string
		        Object obj2 = ois.readObject();
		        if(obj2 instanceof Player){
		        	Player obj3 = (Player)obj2;
		        	System.out.println(obj3.getName());
		        }
	    	 }
	         


	      } catch (Exception ex) {
	         ex.printStackTrace();
	      }
		
	}

	@Override
	public void run() {
		// TODO Auto-generated method stub
		
	}

}
