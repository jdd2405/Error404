package ch.fhnw.error404.DerGrosseDalmuti.server;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

import ch.fhnw.error404.DerGrosseDalmuti.shared.*;

public class Server implements Runnable{
	public static void main(String[] args){
		Server server = new Server();
		
		Thread serverThread = new Thread(server, "Listener");
		serverThread.start();
	      
	}

	@Override
	public void run() {
		try {
	    	  
	    	  // create ServerSocket-listener with port 404
	    	  ServerSocket listener = new ServerSocket(5000, 10, null);
	    	  
	    	  while(true){
	    		  
	    		  	// Wait for and accept an incoming request
	    		  	Socket socket = listener.accept();
				
	    		  	
	  				// create inputStream for objects
	  				InputStream is = socket.getInputStream();
	  				ObjectInputStream ois = new ObjectInputStream( is );
	  			
	  				// read object from inputStream
	  				System.out.println(ois.readObject().getClass());
	  				ois.close();
	  				
	  				
	    		  	// create outputStream for objects
	  				OutputStream os = socket.getOutputStream();
	  				ObjectOutputStream oos = new ObjectOutputStream( os );
	  			
	  				// write object to outputStream
	  				oos.writeObject( object );
	  				oos.flush();
	  				oos.close();
	  			

	    	 }
	         


	      } catch (Exception e) {
	         System.out.println(e.getStackTrace());;
	      }
		
		
	}

}
